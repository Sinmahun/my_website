<!DOCTYPE html>
<html>
<head>
    <title>‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Attendance</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        img { max-width: 200px; height: auto; border-radius: 5px; }
        .btn { background: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
        .btn:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Attendance ‡∏à‡∏≤‡∏Å Database</h1>
        <button class="btn" onclick="loadRecords()">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        <div id="loading" style="display: none;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
        <div id="records"></div>
    </div>

    <script>
        async function loadRecords() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('records').innerHTML = '';
            
            try {
                const response = await fetch('/api/records');
                const data = await response.json();
                
                if (data.success) {
                    let html = '<h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (' + data.data.length + ' ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h2>';
                    
                    if (data.data.length === 0) {
                        html += '<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Database</p>';
                    } else {
                        html += '<table>';
                        html += '<tr><th>ID</th><th>‡∏†‡∏≤‡∏û</th><th>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th></tr>';
                        
                        data.data.forEach(record => {
                            html += `
                                <tr>
                                    <td>${record.id}</td>
                                    <td><img src="/uploads/${record.image}" alt="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û"></td>
                                    <td>${record.period}</td>
                                    <td>${new Date(record.created_at).toLocaleString('th-TH')}</td>
                                </tr>
                            `;
                        });
                        
                        html += '</table>';
                    }
                    
                    document.getElementById('records').innerHTML = html;
                } else {
                    document.getElementById('records').innerHTML = '<p>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + data.message + '</p>';
                }
            } catch (error) {
                document.getElementById('records').innerHTML = '<p>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';
                console.error('Error:', error);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.onload = loadRecords;
    </script>
</body>
</html>